============================================================
  こころのクリニック HP 技術・対策まとめ
  最終更新: 2026-02-09
  CSS/JS バージョン: v=9
============================================================

【基本構成】
- HTML / CSS / JavaScript（フレームワークなし、軽量な静的サイト）
- ホスティング: Netlify（GitHub連携による自動デプロイ）
- CMS: Decap CMS（Netlify Identity + Git Gateway）
- ソースコード: GitHub（munemiti5-glitch/kokoro-clinic）
- フォーム: Formspree（外部サービス、月50件無料）
- フォント: Google Fonts（Noto Sans JP）
- 地図: Google Maps Embed
- ロゴ: オリジナルSVGロゴマーク（葉っぱモチーフ）+ ファビコン

【ページ構成】全17ページ + 404 + CMS管理画面
- index.html              … トップページ
- services.html           … 診療内容
- contact.html            … ご予約・お問い合わせ
- faq.html                … よくある質問
- price.html              … 料金について
- online.html             … オンライン診療
- privacy.html            … プライバシーポリシー
- first-visit.html        … 初めての方へ（持ち物・流れ・費用・FAQ）
- doctor.html             … 院長紹介・ごあいさつ（E-E-A-T強化）
- recruit.html            … 採用情報（看護師・心理士・受付）
- column.html             … 医療コラム一覧
- column-depression.html  … コラム：うつ病（症状・原因・治療法）
- column-panic.html       … コラム：パニック障害（対処法）
- column-sleep.html       … コラム：不眠症（改善のヒント）
- column-stress.html      … コラム：ストレス（受診の目安）
- column-autonomic.html   … コラム：自律神経失調症（セルフチェック）
- 404.html                … エラーページ
- admin/index.html        … CMS管理画面

------------------------------------------------------------
■ SEO対策
------------------------------------------------------------
- title / description / keywords をページごとに個別最適化
- canonical URL で重複コンテンツ防止
- OGP（Open Graph）全ページ設定 → SNSシェア時にサムネ・タイトル表示
- Twitter Card 全ページ設定
- 構造化データ（JSON-LD）10種類搭載
  → MedicalClinic / WebSite / BreadcrumbList / MedicalWebPage
    Physician / Review / HowTo / NewsArticle / FAQPage / CollectionPage
- sitemap.xml で全ページをGoogleに通知
- robots.txt でクロール制御
- パンくずリスト全サブページに設置
- 見出しタグ（h1〜h4）を階層的に正しく使用
- 画像に alt テキストを全て設定

------------------------------------------------------------
■ MEO対策（Googleマップ・ローカル検索）
------------------------------------------------------------
- 構造化データに住所・電話番号・座標（緯度経度）・営業時間を詳細記載
- hasMap でGoogleマップ直リンク設定
- areaServed で大阪市・大阪府を対象エリアとして明示
- aggregateRating で口コミ評価（4.8 / 120件）を構造化データに搭載
- isAcceptingNewPatients: true で新患受付中を明示

------------------------------------------------------------
■ LLMO対策（AI検索・ChatGPT等への対応）
------------------------------------------------------------
- robots.txt で GPTBot / ClaudeBot / Google-Extended を許可
- MedicalWebPage 構造化データで医療情報の専門性を明示
- Physician 構造化データで医師の資格・経歴を詳細記載
- E-E-A-T の監修情報をページ下部に表示

------------------------------------------------------------
■ セキュリティ対策
------------------------------------------------------------
- HTTPS強制（HSTS: 2年間 + プリロード対応）
- Content-Security-Policy（CSP）で読み込み元を厳格に制限
  → CMS管理画面（/admin/）は専用の緩和CSPを適用
- X-Frame-Options でクリックジャッキング防止
- X-Content-Type-Options でMIMEスニッフィング防止
- Referrer-Policy で送信先情報を制限
- Permissions-Policy でカメラ・マイク・位置情報等を全ブロック
- Cross-Origin-Opener-Policy / Resource-Policy 設定
- フォームにXSSパターン検出・HTMLエスケープ・ハニーポット（ボット対策）
- レート制限（1分3回）・二重送信防止を実装
- .well-known/security.txt でセキュリティ連絡先を公開

------------------------------------------------------------
■ アクセシビリティ（a11y）
------------------------------------------------------------
- スキップナビゲーション（キーボード操作でメインコンテンツへ直行）
- aria-label / aria-expanded / aria-controls / aria-current を適切に使用
- prefers-reduced-motion 対応（アニメーション全無効化）
- :focus-visible でキーボード操作時のフォーカス表示
- フォームエラーに aria-live でスクリーンリーダー対応
- role="img" + aria-label で背景画像のテキスト代替

------------------------------------------------------------
■ パフォーマンス最適化
------------------------------------------------------------
- CSS / JS にキャッシュバスター（?v=9）で更新反映を保証
- _headers でCSS/JS/画像を1年キャッシュ（immutable）
- HTMLは1時間キャッシュ + must-revalidate
- Google Fonts に preconnect で接続を事前確立
- CSS を preload でLCP（最大表示要素）改善
- 画像に loading="lazy" decoding="async" で遅延読み込み
- JS に defer で読み込みブロック防止

------------------------------------------------------------
■ PWA（プログレッシブウェブアプリ）
------------------------------------------------------------
- manifest.json でホーム画面追加対応
- Service Worker でオフライン対応（開発中は無効化、本番で有効化）
- ショートカット設定（予約・診療内容・FAQ）

------------------------------------------------------------
■ 表示の安定性・バグ防止
------------------------------------------------------------
- CSS変数で色・余白・影を一元管理 → デザイン崩れ防止
- レスポンシブ対応 4段階（1024px / 768px / 480px + デフォルト）
- color-scheme: light only でダークモード強制無効 → 医療サイトの可読性保証
- 印刷スタイル完備（不要なボタン・ナビ・iframe非表示）
- ローダーに3秒フォールバック → 読み込み失敗でも画面が止まらない
- JSロード前でもコンテンツが見える設計（.js-loaded クラスで段階適用）
- エラーハンドラー（window.onerror / unhandledrejection）でJSクラッシュをキャッチ

------------------------------------------------------------
■ UI/UX 演出（プレミアムモーション）
------------------------------------------------------------
- ローディングアニメーション（初回のみ、sessionStorageで制御）
- ページ遷移アニメーション（内部リンク移動時）
- スクロールプログレスバー（読み進み度の可視化）
- カスタムカーソル（デスクトップのみ、タッチ端末は無効）
- フローティングシェイプ（ヒーロー背景の装飾SVG）
- スタガー付きフェードインアニメーション
- 3Dチルトエフェクト（カードホバー時）
- ボタンリップルエフェクト
- マグネティックボタン（ボタンがカーソルに引き寄せられる）
- 数字カウントアップアニメーション（実績セクション）
- パララックス背景（ヒーローセクション）

------------------------------------------------------------
■ CMS（コンテンツ管理システム）
------------------------------------------------------------
- Decap CMS（旧Netlify CMS）でブラウザから記事投稿・編集が可能
- 管理画面URL: https://kokoro-clinic.netlify.app/admin/
- ログイン: munemiti5@gmail.com
- 投稿可能なコンテンツ:
  → お知らせ（日付・カテゴリ・本文）
  → 医療コラム（タイトル・カテゴリ・抜粋・サムネイル・本文）
  → 固定ページ（トップのお知らせ欄・診療時間の臨時変更）
- 認証: Netlify Identity（Invite only設定済み）
- データ保存: GitHubリポジトリにMarkdownファイルとして保存
- 画像アップロード: images/ フォルダに自動保存

------------------------------------------------------------
■ CSS設計
------------------------------------------------------------
- 全ページのスタイルを css/style.css に一元管理（HTMLにインラインCSS無し）
- CSS変数で色・余白・影・角丸を統一管理
- セクション別コメントで構造化（検索しやすい）
- レスポンシブブレークポイント: 1024px / 768px / 480px

------------------------------------------------------------
■ デプロイ・運用
------------------------------------------------------------
- GitHub: https://github.com/munemiti5-glitch/kokoro-clinic
- Netlify: https://kokoro-clinic.netlify.app
- デプロイ方法: GitHubにpush → Netlifyが自動デプロイ
- CMS経由の更新: /admin/ からログイン → 記事投稿 → 自動でGitHubにcommit → 自動デプロイ

【デプロイ手順（コード変更時）】
  1. コマンドプロンプトを開く
  2. cd "c:\Users\user\Desktop\Cursor作業用\kokoro-clinic"
  3. git add -A
  4. git commit -m "変更内容の説明"
  5. git push
  → 1〜2分で自動反映

------------------------------------------------------------
■ 未実装・クライアント決定待ち
------------------------------------------------------------
【納品前に必須】
- [ ] 独自ドメイン取得 → 全ファイルの「kokoro-clinic.example.com」を一括置換
- [ ] Formspree のフォームID取得 → contact.html の「your-form-id」を差し替え
- [ ] 実写真の差し替え（院内・医師・スタッフ・外観・ギャラリー等）
- [ ] LINE公式アカウントのURL → 固定LINEボタン・フッターのリンク差し替え
- [ ] SNSアカウント作成 → Instagram / X のリンク差し替え（未作成なら非表示化）

【納品後 早めに対応】
- [ ] Googleアナリティクス（GA4）のタグ設置 → アクセス計測
- [ ] Googleサーチコンソール登録 → 検索パフォーマンス計測・sitemap送信
- [ ] Googleビジネスプロフィール登録 → Googleマップ表示・MEO本格対策

【実装済み】
- [x] ブログ/医療コラムページ追加（5本 + 一覧ページ）
- [x] CMS化（Decap CMS + Netlify Identity + Git Gateway）
- [x] オリジナルSVGロゴマーク（全ページ適用済）
- [x] GitHub連携 + 自動デプロイ設定
- [x] 全ページCSS一元化（インラインCSS完全排除）
- [x] キャッシュバスター v=9

【将来的に追加検討】
- [ ] Service Worker 有効化（本番用、index.html のSW解除コードを削除）
- [ ] コラム記事の追加（適応障害、社交不安障害、ADHD、産後うつ等）
- [ ] コラムのOGP画像を記事ごとに個別作成
